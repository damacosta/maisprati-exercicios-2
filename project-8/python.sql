CREATE TABLE CARDAPIO (
  NOME VARCHAR(100),
  DESCRICAO VARCHAR(255),
  PRECO DECIMAL(10, 2)
);

INSERT INTO CARDAPIO (NOME, DESCRICAO, PRECO)
VALUES 
  ('LATTE', 'COM LEITE', 10.00),
  ('COADO', 'NO FILTRO', 20.00),
  ('EXPRESSO', 'DE MAQUININHA', 30.00);


CREATE TABLE COMANDAS (
  CODIGO INT,
  DATA DATETIME,
  MESA INT,
  NOME_CLIENTE VARCHAR(100)
);

INSERT INTO COMANDAS (CODIGO, DATA, MESA, NOME_CLIENTE)
VALUES 
  (1, '2025-11-01 15:00:00', 1, 'José'),
  (2, '2025-11-02 16:00:00', 11, 'Almir'),
  (3, '2025-11-03 17:00:00', 7, 'Sansão')

CREATE TABLE ITENS_DA_COMANDA (
  CODIGO_COMANDA INT,
  NOME_CAFE VARCHAR(100),
  QUANTIDADE INT,
);

INSERT INTO ITENS_DA_COMANDA (CODIGO_COMANDA, NOME_CAFE, QUANTIDADE)
VALUES 
  (1, 'LATTE', 2),
  (1, 'COADO', 2),
  (2, 'EXPRESSO', 1),
  (3, 'LATTE', 2),
  (3, 'COADO', 1),
  (3, 'EXPRESSO', 3);

SELECT NOME, DESCRICAO, PRECO 
FROM CARDAPIO 
ORDER BY NOME ASC;


SELECT 
  CO.CODIGO,
  CA.NOME,
  CA.DESCRICAO,
  IT.QUANTIDADE,
  CA.PRECO,
  IT.QUANTIDADE * CA.PRECO AS PRECO_TOTAL
FROM COMANDAS AS CO
INNER JOIN ITENS_DA_COMANDA AS IT ON CO.CODIGO = IT.CODIGO_COMANDA 
INNER JOIN CARDAPIO AS CA ON IT.NOME_CAFE = CA.NOME

SELECT 
  CO.CODIGO,
  CO.DATA,
  CO.MESA,
  CO.NOME_CLIENTE,
  SUM(IT.QUANTIDADE * CA.PRECO) AS VALOR_TOTAL
FROM COMANDAS AS CO
INNER JOIN ITENS_DA_COMANDA AS IT ON CO.CODIGO = IT.CODIGO_COMANDA 
INNER JOIN CARDAPIO AS CA ON IT.NOME_CAFE = CA.NOME 
GROUP BY CO.CODIGO, CO.DATA, CO.MESA, CO.NOME_CLIENTE -
ORDER BY CO.DATA;

SELECT 
  CO.CODIGO,
  CO.DATA,
  CO.MESA,
  CO.NOME_CLIENTE,
  SUM(IT.QUANTIDADE * CA.PRECO) AS VALOR_TOTAL
FROM COMANDAS AS CO
INNER JOIN ITENS_DA_COMANDA AS IT ON CO.CODIGO = IT.CODIGO_COMANDA
INNER JOIN CARDAPIO AS CA ON IT.NOME_CAFE = CA.NOME
GROUP BY CO.CODIGO, CO.DATA, CO.MESA, CO.NOME_CLIENTE
HAVING COUNT(DISTINCT IT.NOME_CAFE) > 1; 


SELECT 
  CO.DATA,
  SUM(IT.QUANTIDADE * CA.PRECO) AS FATURAMENTO_TOTAL
FROM ITENS_DA_COMANDA AS IT
INNER JOIN COMANDAS AS CO ON IT.CODIGO_COMANDA = CO.CODIGO
INNER JOIN CARDAPIO AS CA ON IT.NOME_CAFE = CA.NOME
GROUP BY CO.DATA
ORDER BY CO.DATA ASC; 